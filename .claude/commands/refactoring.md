# refactoring

프로젝트 개발 중간중간 **기능 점검 + 리팩토링**을 수행하는 커맨드.  
목표는 “동작 안정화 + 코드 품질/유지보수성 개선”이며, **라우팅/유저 플로우와 핵심 사업 방향은 절대 변경하지 않는다.**

---

## 고정 사항 (절대 변경 금지)

아래 항목은 리팩토링 과정에서 **절대 변경하지 말 것**:

1) **라우팅/유저 플로우 고정**
- `/` (랜딩) → `/trial/start` 또는 `/auth/login` → 로그인 성공 시 `/main`
- `/main` 상단 우측 “마이페이지” 버튼: role에 따라 이동
  - influencer → `/influencer/feed`
  - advertiser → `/advertiser/feed`

2) **브랜드명**
- 서비스명은 **I:EUM**
- 좌측 상단 브랜드 텍스트(메인 이동 링크 포함)는 **I:EUM** 유지

3) **인증/DB 큰 변경 금지**
- Firebase 기반 인증/DB 구조는 유지
- 마이그레이션(인증 방식 전환, DB 스키마 대개편) 금지

---

## 수행 작업

다음 순서로 점검 및 개선을 수행한다.

### 1) 기능 점검 (Stability & Correctness)
- 로그인/회원가입/로그아웃 플로우 오류 여부 점검
- role 기반 라우팅/권한 체크 누락 여부 점검
- 캠페인 목록/상세/생성 흐름에서 페이지 깨짐, 데이터 불일치, 경로 혼재 점검
- 콘솔 에러/경고, 런타임 에러, 타입 에러, 빌드 에러 가능성 점검
- dev 환경 이슈 점검
  - Turbopack/webpack 옵션 혼재
  - tsconfig 충돌 가능성
  - 캐시/의존성 문제 재현 가능성

### 2) 리팩토링 (Maintainability & Deduplication)
- 중복 컴포넌트/스타일/유틸 제거 및 공용화
- 역할별 영역(influencer/advertiser/admin)의 공통 UI 레이아웃 추출
- 데이터 fetch/상태관리 로직 정리
  - 불필요한 useEffect 남용 제거
  - 로딩/에러/empty state 패턴 통일
- 상수/라벨/색상/상태 매핑 중앙화
  - 예: statusLabels/statusColors 등
- 타입 강화(TypeScript)
  - any 제거, 타입 정의 정리
  - Firestore 모델 타입/DTO 정리
- 폴더 구조 정리(라우팅 구조는 유지)
  - components, lib, hooks, types 등 내부 구조 개선

### 3) 성능/품질 (Performance & Quality)
- 불필요한 리렌더/클라이언트 컴포넌트 남용 점검
  - 가능하면 서버 컴포넌트 활용
- 번들/이미지/폰트 최적화(과도한 변경 없이 가능한 범위)
- 접근성 기본 점검(버튼/링크/aria)
- 린트/타입체크/빌드 안정성 확보

---

## 리팩토링하지 않는 것

- 대규모 신규 기능 추가
- UI/디자인 전면 개편(톤/색감 미세 조정 수준은 허용되나, 구조적 재설계 금지)
- 라우팅/유저 플로우 변경
- DB 스키마/인증 방식 마이그레이션
- 동작에 영향 없는 사소한 포맷팅/취향 레벨 변경

---

## 산출물 (반드시 제공)

### 1) 진단 리포트
- 문제 목록을 심각도별로 정리
- 재현 조건/원인/영향/수정 방향 요약

### 2) 리팩토링 계획
- 작업을 5~10개 단위 PR/커밋으로 쪼개서 제시
- 각 단위별: 변경 파일/핵심 수정 내용/리스크/테스트 포인트 포함

### 3) 즉시 적용 가능한 핵심 수정
- 크리티컬 오류/구성 문제(tsconfig, dev 설정, auth guard 등)는 즉시 수정 반영

### 4) 최종 결과 확인 체크리스트
- 주요 페이지 접속 및 플로우 테스트 항목 정리

---

## 출력 형식

각 이슈마다 다음 형식으로 작성:

```markdown
### [심각도] 이슈 제목
**범주**: Stability | Maintainability | Performance | Security | DX
**위치**: 파일명:라인번호 (가능한 경우)

**문제점**
[현재 코드에서 발생하는 구체적인 문제 상황 / 재현 조건]

**원인**
[왜 발생하는지, 어떤 구조/의존성/설정 때문에 생기는지]

**영향**
[유저 영향, 장애 가능성, 데이터/보안 위험, 유지보수 비용]

**개선 방향**
[구체적인 수정 방향/대안(필요 시 단계별)]

**검증 방법**
[수정 후 확인할 테스트/시나리오]
